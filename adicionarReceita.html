<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Adicionar Receita</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --orange:#f39200;
    --bg:#f9f5f0;
    --muted:#555;
  }

html, body {
  height: 100%;
  margin: 0;
  font-family: Roboto, sans-serif;
  background: var(--bg);
  color: #222;
  overflow-x: hidden;   /* impede rolagem lateral */
  max-width: 100%;
}

  header{
    background:var(--orange);
    color:#fff;
    padding:1rem 1.25rem;
    display:flex;
    align-items:center;
    justify-content:space-between;
  }

  header h1{
    margin:0;
    font-size:1.25rem;
  }

  .close-btn{
    background:transparent;
    border:0;
    color:#fff;
    font-weight:700;
    font-size:1rem;
    cursor:pointer;
  }

main {
  padding: 2rem 2.5rem;
  width: 100%;
  max-width: 100%;
  box-sizing: border-box; /* evita estourar a largura */
}
  /* REMOVE PAINEL BRANCO — agora tudo é full-screen */
  form{
    width:100%;
    max-width:100%;
  }

  .row {
  display: flex;
  gap: 2rem;
  margin-bottom: 1rem;
  width: 100%;
  flex-wrap: wrap;   /* evita ultrapassar a tela */
  box-sizing: border-box;
}

  .col{
    flex:1;
    min-width:0;
  }

  label{
    display:block;
    font-size:0.875rem;
    margin-bottom:0.35rem;
    color:var(--muted);
  }

  input[type="text"], input[type="file"], select, textarea {
    width:100%;
    padding:0.6rem 0.75rem;
    border-radius:8px;
    border:1px solid #ccc;
    background:#fff;
    font-size:0.95rem;
  }

  textarea{
    min-height:120px;
    resize:vertical;
    padding-top:0.75rem;
  }

  .small{
    font-size:0.85rem;
    color:#888;
    margin-top:0.35rem;
  }

  .photo-preview{
    width:100%;
    height:240px;
    border-radius:10px;
    background:linear-gradient(180deg,#f5f3f1,#eee9e5);
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
  }

  .photo-preview img{
    width:100%;
    height:100%;
    object-fit:cover;
  }

  .actions{
    display:flex;
    gap:0.75rem;
    justify-content:flex-end;
    margin-top:1.5rem;
  }

  .btn{
    padding:0.7rem 1rem;
    border-radius:10px;
    border:0;
    font-weight:700;
    cursor:pointer;
  }

  .btn.secondary{
    background:#ddd;
    color:#222;
  }

  .btn.primary{
    background:var(--orange);
    color:#fff;
  }

  @media(max-width:820px){
    .row{
      flex-direction:column;
    }
    .photo-preview{
      height:180px;
    }
  }
</style>
</head>

<body>

<header>
  <h1>Adicionar Receita</h1>
  <button class="close-btn" onclick="location.href='index.html'">Fechar ✕</button>
</header>

<main>
  <form id="formReceita" autocomplete="off" novalidate>

    <div class="row">
      <div class="col" style="max-width:340px">
        <label for="foto">Foto da receita *</label>
        <div class="photo-preview" id="previewBox">
          <span id="previewPlaceholder" style="color:#7b7b7b">Nenhuma imagem escolhida</span>
          <img id="previewImg" src="" alt="" style="display:none">
        </div>
        <input id="foto" name="foto" type="file" accept="image/*" required style="margin-top:0.6rem">
        <div class="small">Escolha uma imagem.</div>
        <div class="error" id="errFoto" style="display:none;color:#b00020"></div>
      </div>

      <div class="col">
        <label for="nome">Nome da receita *</label>
        <input id="nome" name="nome" type="text" placeholder="Ex: Bolo de Cenoura">

        <div class="row" style="margin-top:0.75rem">
          <div class="col">
            <label for="tempo">Tempo *</label>
            <input id="tempo" type="text" placeholder="40 min">
          </div>
          <div class="col" style="max-width:200px">
            <label for="dificuldade">Dificuldade *</label>
            <select id="dificuldade">
              <option value="">Selecione</option>
              <option>Fácil</option>
              <option>Médio</option>
              <option>Difícil</option>
            </select>
          </div>
        </div>

        <div class="row" style="margin-top:0.75rem">
          <div class="col">
            <label for="categoria">Categoria *</label>
            <select id="categoria">
              <option value="">Selecione</option>
              <option value="vegana">Vegana</option>
              <option value="lanches">Lanches</option>
              <option value="massadoce">Massa Doce</option>
              <option value="japonesa">Japonesa</option>
            </select>
          </div>

          <div style="width:140px;display:flex;align-items:flex-end">
            <button type="button" id="btnPreview" class="btn secondary" style="width:100%">Prévia</button>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label for="utensilios">Utensílios</label>
        <textarea id="utensilios"></textarea>
      </div>

      <div class="col">
        <label for="ingredientes">Ingredientes *</label>
        <textarea id="ingredientes"></textarea>
        <div class="error" id="errIngredientes" style="display:none;color:#b00020"></div>
      </div>
    </div>

    <label for="preparo">Modo de preparo *</label>
    <textarea id="preparo"></textarea>
    <div class="error" id="errPreparo" style="display:none;color:#b00020"></div>

    <div class="actions">
      <button type="button" class="btn secondary" onclick="location.href='index.html'">Cancelar</button>
      <button class="btn primary" type="submit">Salvar Receita</button>
    </div>

    <div id="msg" style="margin-top:1rem;color:green;display:none"></div>
  </form>
</main>

<script>
  /* SEU JAVASCRIPT ORIGINAL COMPLETO AQUI — intacto */

  function makeId(name){
    const base = name.trim().toLowerCase()
      .replace(/[^a-z0-9]+/g,'-')
      .replace(/^-+|-+$/g,'');
    const stamp = Date.now().toString(36).slice(-6);
    return `${base}-${stamp}`;
  }

  function fileToDataURL(file){
    return new Promise((resolve,reject)=>{
      const reader = new FileReader();
      reader.onload = ()=> resolve(reader.result);
      reader.onerror = reject;
      reader.readAsDataURL(file);
    });
  }

  const form = document.getElementById('formReceita');
  const inputFoto = document.getElementById('foto');
  const previewImg = document.getElementById('previewImg');
  const previewPlaceholder = document.getElementById('previewPlaceholder');

  let fotoDataURL = null;

  inputFoto.addEventListener('change', async function(){
    const file = this.files[0];
    document.getElementById('errFoto').style.display = 'none';
    if(!file){
      fotoDataURL = null;
      previewImg.style.display = 'none';
      previewPlaceholder.style.display = 'block';
      return;
    }
    if(!file.type.startsWith('image/')){
      document.getElementById('errFoto').textContent = 'Escolha uma imagem válida.';
      document.getElementById('errFoto').style.display = 'block';
      this.value = '';
      return;
    }
    fotoDataURL = await fileToDataURL(file);
    previewImg.src = fotoDataURL;
    previewImg.style.display = 'block';
    previewPlaceholder.style.display = 'none';
  });

  document.getElementById('btnPreview').addEventListener('click', ()=>{
    if(!fotoDataURL){
      document.getElementById('errFoto').textContent = 'Escolha uma foto antes.';
      document.getElementById('errFoto').style.display = 'block';
    }
  });

  form.addEventListener('submit', function(ev){
    ev.preventDefault();
    const nome = document.getElementById('nome').value.trim();
    const ingredientes = document.getElementById('ingredientes').value.trim();
    const preparo = document.getElementById('preparo').value.trim();

    if(!fotoDataURL || !nome || !ingredientes || !preparo){
      document.getElementById('msg').textContent = 'Preencha todos os campos obrigatórios.';
      document.getElementById('msg').style.color = 'red';
      document.getElementById('msg').style.display = 'block';
      return;
    }

    document.getElementById('msg').textContent = 'Receita salva!';
    document.getElementById('msg').style.color = 'green';
    document.getElementById('msg').style.display = 'block';
  });
</script>

</body>
</html>
