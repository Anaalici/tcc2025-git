<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8">
    <title>Categorias - Receita de Mestre</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
        <link rel="icon" href="img/favicon.png" type="image/png">

    <style>
        body {
            font-family: Roboto, sans-serif;
            background: #f9f5f0;
            margin: 0;
            padding: 1.25em;
            color: #333;
        }

        .back-btn {
            display: inline-block;
            margin-bottom: 1em;
            padding: 0.5em 0.75em;
            background: #f39200;
            color: #fff;
            border-radius: 0.5em;
            text-decoration: none;
        }

        h1 {
            text-align: center;
            color: #f39200;
            margin: 0.5em 0 1.125em;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(13.75em, 1fr));
            gap: 1.25em;
        }

        .card {
            background: #fff;
            border-radius: 0.75em;
            overflow: hidden;
            box-shadow: 0 0.375em 1.25em rgba(0, 0, 0, 0.08);
            cursor: pointer;
            transition: transform .18s;
            position: relative;
        }

        .card:hover {
            transform: translateY(-0.375em);
        }

        .card img {
            width: 100%;
            height: 8.75em;
            object-fit: cover;
        }

        .card-content {
            padding: 0.75em;
        }

        .card-content h3 {
            margin: 0;
            color: #f39200;
            font-size: 1.05rem;
        }

        .card-content p {
            margin: 0.375em 0 0;
            color: #555;
            font-size: 0.9rem;
        }

        a {
            color: inherit;
            text-decoration: none;
        }

        .fav-btn {
            position: absolute;
            top: 0.625em;
            right: 0.625em;
            background-color: #fff;
            width: 2em;
            height: 2em;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 3;
            transition: transform .2s;
        }


        .fav-btn svg {
            width: 1.25em;
            height: 1.25em;
            fill: none;
            stroke: #000;
            stroke-width: 0.125em;
        }

        .fav-btn.active svg path {
            fill: #ff3b3b;
            stroke: #ff3b3b;
        }
    </style>
</head>

<body>

    <a href="index.html#categoria" class="back-btn">← Voltar para categorias</a>
    <h1 id="tituloCategoria">Receitas</h1>
    <div class="grid" id="listaReceitas"></div>

    <script src="receitasData.js"></script>

    <script>
    (function() {
      if(!window.categorias){
        document.getElementById('listaReceitas').innerHTML='<p>Erro: dados não encontrados.</p>';
        return;
      }

      const lista = [].concat(...Object.values(window.categorias));
      const container = document.getElementById('listaReceitas');
      const favoritos = JSON.parse(localStorage.getItem("favoritos") || "[]");

      lista.forEach(r=>{
        const card = document.createElement("div");
        card.className = "card";

        const ativo = favoritos.includes(r.id) ? "active" : "";

        card.innerHTML = `
          <div class="fav-btn ${ativo}" onclick="toggleFavorito(event,'${r.id}')">
            <svg viewBox="0 0 24 24">
              <path d="M12.1 8.64c-1.44-1.72-4.12-1.72-5.56 0a3.93 3.93 0 000 5.28L12 19.4l5.46-5.48a3.93 3.93 0 000-5.28c-1.44-1.72-4.12-1.72-5.36 0z"/>
            </svg>
          </div>
          <a href="receitas.html?r=${encodeURIComponent(r.id)}">
            <img src="${r.imagem}" alt="${r.nome}">
            <div class="card-content">
              <h3>${r.nome}</h3>
              <p>${r.dificuldade} • ${r.tempo}</p>
            </div>
          </a>
        `;

        container.appendChild(card);
      });
    })();

    window.toggleFavorito = function(e,id){
      e.preventDefault();
      e.stopPropagation();

      const btn = e.currentTarget;
      btn.classList.toggle("active");

      let favs = JSON.parse(localStorage.getItem("favoritos") || "[]");
      if(btn.classList.contains("active")){
        if(!favs.includes(id)) favs.push(id);
      }else{
        favs = favs.filter(x=>x!==id);
      }

      localStorage.setItem("favoritos",JSON.stringify(favs));
    }
  </script>
</body>

</html>